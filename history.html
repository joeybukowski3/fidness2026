<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Workout History - Pro Trainer Elite</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #f1f5f9; --bg2: #ffffff; --text: #1e293b; --text2: #475569; --border: #e2e8f0; --accent: #16a34a; --radius: 12px;
}
.dark {
  --bg: #0f172a; --bg2: #1e293b; --text: #f1f5f9; --text2: #cbd5e1; --border: #334155;
}
body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); padding: 1.5rem; margin: 0; }
.container { max-width: 800px; margin: 0 auto; }
.header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; }
.card { background: var(--bg2); padding: 1.5rem; border-radius: var(--radius); border: 1px solid var(--border); box-shadow: 0 1px 3px rgba(0,0,0,0.08); margin-bottom: 1rem; }
h1 { font-size: 1.5rem; font-weight: 800; margin: 0; }
.btn { display: inline-block; padding: 0.6rem 1rem; background: var(--accent); color: white; text-decoration: none; border-radius: 8px; font-weight: 700; font-size: 0.85rem; }
.history-item { border-bottom: 1px solid var(--border); padding: 0.75rem 0; display: flex; justify-content: space-between; align-items: center; }
.history-item:last-child { border-bottom: none; }
.ex-name { font-weight: 700; font-size: 0.9rem; }
.ex-meta { font-size: 0.8rem; color: var(--text2); }
.empty-state { text-align: center; padding: 3rem; color: var(--text2); }
</style>
</head>
<body class="light">
<div class="container">
  <div class="header">
    <h1>Workout History</h1>
    <a href="index.html" class="btn">Back to App</a>
  </div>
  <div id="historyList"></div>
</div>

<script>
  if (JSON.parse(localStorage.getItem('wt_state') || '{}').dark) {
    document.body.classList.replace('light', 'dark');
  }

  const history = JSON.parse(localStorage.getItem('wt_ex_history') || '[]');
  const container = document.getElementById('historyList');

  const HIDE_LOAD_INPUT_CATEGORIES = new Set(['stretches', 'cardio', 'yoga']);
  function getExerciseCategory(name) {
    if (!name) return 'Strength';
    const n = name.toLowerCase();
    if (n.includes('stretch')) return 'Stretches';
    if (n.includes('yoga') || n.includes('pose')) return 'Yoga';
    if (n.includes('walk') || n.includes('bike') || n.includes('elliptical')) return 'Cardio';
    return 'Strength';
  }
  function shouldHideLoadInputs(category) {
    return HIDE_LOAD_INPUT_CATEGORIES.has((category || '').toLowerCase());
  }

  if (history.length === 0) {
    container.innerHTML = '<div class="card empty-state"><p>No workout history found. Start training to see your progress!</p></div>';
  } else {
    const reversed = [...history].reverse();
    let currentDay = '';
    let html = '';

    reversed.forEach(item => {
      const date = new Date(item.ts);
      const dayLabel = date.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
      
      if (dayLabel !== currentDay) {
        if (currentDay !== '') html += '</div>';
        html += `<div class="card"><h3>${dayLabel}</h3>`;
        currentDay = dayLabel;
      }

      const category = getExerciseCategory(item.exercise);
      const hideInputs = shouldHideLoadInputs(category);

      html += `
        <div class="history-item">
          <div>
            <div class="ex-name">${item.exercise}</div>
            <div class="ex-meta">${date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</div>
          </div>
          ${hideInputs ? '<div style="font-size:0.75rem;color:var(--accent);font-weight:700;">Completed</div>' : `<div class="ex-meta"><strong>${item.weight || '-'}</strong> lbs x <strong>${item.reps || '-'}</strong> reps</div>`}
        </div>
      `;
    });
    html += '</div>';
    container.innerHTML = html;
  }
</script>
</body>
</html>